[[0. Resources Used for Practicing PBB]]
### What is **Sub-Domain Enumeration ?**
- Subdomain discovery is the **process of finding what subdomains exist given a domain name.** For example, the domain `tcm-sec.com` might have the subdomains `dev.tcm-sec.com` and `blog.tcm-sec.com`.
#### Resource : [# DNS Bruteforce using AXIOM By Otterly](https://ott3rly.com/dns-bruteforce-using-axiom/)
### **The Wordlists to use :** 
- **Assetnote** [Best-Assetnote-Subdomain-Wordlist](https://wordlists-cdn.assetnote.io/data/manual/best-dns-wordlist.txt)
- **Seclists** [SUBDOMAIN-WORDLIST](https://wordlists-cdn.assetnote.io/data/manual/best-dns-wordlist.txt)
### **Passive Discovery**
- **Definition:**Â Collecting subdomains **without directly interacting** with target infrastructure.
- subfinder
```markdown

# Installation:
- https://github.com/projectdiscovery/subfinder.git

## Using go to isntall:
- go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
  
- Now done, run this " cp ~/go/bin/subfinder /usr/local/bin "
  
```
- Assetfinder (passive only)
```shell
# 2. Assetfinder (passive only)
assetfinder target.com
```
- **Google Dork** or use his **[Google Dorking Site](https://dorkgenv2.vercel.app/)**.
```shell
site:*.aikido.dev
```
- [https://crt.sh/](https://crt.sh/)
```shell
curl -s "https://crt.sh/?q=%.target.com&output=json" | jq -r '.[].name_value'
```
### **Active Discovery** 
- **Definition:**Â **Directly querying** target's DNS servers.
- subfinder : `use this swtiches -active`
- DNSRecon
- Amass
- Ffuf
```shell
ffuf -u <target> -w /path/to/wordlist.txt -H "Host: FUZZ.target.com" -fs <size-filter>
```

## Subdomain Enumeration Using Certain Websites : 

### **1. Using VirusTotal Search Method : [here](https://www.virustotal.com/gui/home/search)**

- Once its done searching, click on **RELATIONS** tab, and look for **Subdomains.**
	![[Subdomain_Enumeration_using_virustotal.png]]
- If needed you can download the subdomain graph from them. TO DO THAT : 
	1. Scroll down in the **RELATIONS** tab, you should see a **Graph Summary** section click on subdomains and it will give you a subdomain graph.
### **2. Using Search in Censys.io : [here](https://platform.censys.io/search)**

- Goto search tab and type ur target, then search it and then under **Search Results --> Asset Type --> select Certificates.** 
	![[Subdomain_Enumeration_using_censys.png]]

### **3. Using # DorkSearchPRO: Google Dorks Generator : [here](https://dorksearch.pro/)**

- Goto this site in **TARGET DOMAIN** : `type ur target --> scroll down look for OSINT & RECON --> click on subdomains --> click on it and it will open subdomain in new tab`
![[Subdomain_Enumeration_using_dorking.png]]

### 4. Using DORK_SEARCH : [here](https://platform.censys.io/search)


## **BEST SUBDOMAIN WORDLISTS**
### **ðŸ“ SMALL**Â (Quick scan ~5k)

```shell
/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
```
### **ðŸ“ MEDIUM**Â (Balanced ~20k)

```shell
/usr/share/wordlists/assetnote/best-dns-wordlist.txt  # â† BEST
```
### **ðŸ“ LARGE**Â (Deep scan ~100k+)

```shell
# Combine multiple lists
cat /usr/share/wordlists/assetnote/best-dns-wordlist.txt \
    /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt | \
    sort -u > large_wordlist.txt
```

> **UseÂ `best-dns-wordlist.txt`Â for most scans.**
## Ultimate Subdomain Enumeration Setup

### **Core Stack: Subfinder  + Knockpy + HTTPX**

####  **1. Passive Enumeration (Phase 1)**

```shell
# Primary: Subfinder (fast passive)
subfinder -d TARGET -silent -o subfinder.txt

# Tertiary: Assetfinder (alternative)
assetfinder --subs-only TARGET | tee assetfinder.txt

# Combine passive results
cat subfinder.txt amass_passive.txt assetfinder.txt | \
  sort -u > passive_subs.txt

echo "[+] Passive enumeration: $(wc -l passive_subs.txt) subdomains"
```
#### **2. Active Enumeration (Phase 2)** 

```shell
# Active DNS brute force: Knockpy
knockpy TARGET -o knockpy_results.json

# Extract subdomains from Knockpy
cat knockpy_results.json | jq -r '.subdomains[]' | sort -u > knockpy_subs.txt

# Alternative: FFUF for DNS brute force
ffuf -u https://FUZZ.aikido.dev -w /usr/share/wordlists/assetnote/best-dns-wordlist.txt -t 100 -mc 200,301,302,403 -o ffuf_subs.txt

# Combine active results
cat knockpy_subs.txt ffuf_subs.txt | sort -u > active_subs.txt
echo "[+] Active enumeration: $(wc -l active_subs.txt) subdomains"
```
#### **3. Certificate Transparency (Phase 3)**

```shell
# crt.sh certificate logs
curl -s "https://crt.sh/?q=%.TARGET&output=json" | \
  jq -r '.[].name_value' | \
  sed 's/\*\.//g' | \
  sort -u > crt_subs.txt

# Combine with existing results
cat passive_subs.txt active_subs.txt crt_subs.txt | \
  sort -u > all_subs_raw.txt
echo "[+] Total raw subdomains: $(wc -l all_subs_raw.txt)"
```
#### **4. Verification & Filtering (Phase 4)**

```shell

# Remove wildcards and invalid domains
cat all_subs_raw.txt | \
  grep -v "^\*" | \
  grep -E "^[a-zA-Z0-9.-]+\.TARGET$" | \
  sort -u > filtered_subs.txt

# Verify which are live with HTTPX
cat filtered_subs.txt | \
  httpx \
    -silent \
    -title \
    -status-code \
    -tech-detect \
    -content-length \
    -o live_subs_detailed.txt

# Extract just live subdomains
cat live_subs_detailed.txt | awk '{print $1}' | sed 's|https://||' | sed 's|http://||' > live_subs.txt

echo "[+] Live subdomains: $(wc -l live_subs.txt)"

```
#### **5. Categorization & Analysis (Phase 5)**

```shell
#!/bin/bash
# Categorize discovered subdomains
echo "[+] Categorizing subdomains..."

# 1. Critical infrastructure
grep -E -i "(api|app|admin|dashboard|login|auth|secure|portal|console)" live_subs.txt | sort -u > critical_subs.txt
echo "  â†’ Critical: $(wc -l critical_subs.txt)"

# 2. Development/Staging
grep -E -i "(dev|staging|test|qa|sandbox|demo|uat)" live_subs.txt | sort -u > dev_subs.txt
echo "  â†’ Development: $(wc -l dev_subs.txt)"

# 3. Internal/Private
grep -E -i "(internal|private|intra|vpn|secure|corp|employee)" live_subs.txt | sort -u > internal_subs.txt
echo "  â†’ Internal: $(wc -l internal_subs.txt)"

# 4. Cloud/Services
grep -E -i "(s3|bucket|storage|cloud|aws|azure|gcp|cdn)" live_subs.txt | sort -u > cloud_subs.txt
echo "  â†’ Cloud: $(wc -l cloud_subs.txt)"

# 5. Geographic/Regional
grep -E -i "(us|uk|eu|de|fr|jp|sg|au|ca|mx|br|in)" live_subs.txt | sort -u > geo_subs.txt
echo "  â†’ Geographic: $(wc -l geo_subs.txt)"

# 6. Status codes breakdown
cat live_subs_detailed.txt | awk '{print $2}' | sort | uniq -c | sort -rn > status_codes.txt
echo "  â†’ Status codes saved"
```
#### **6. Takeover Scanning (Phase 6)**

```shell
# Check for subdomain takeovers
cat live_subs.txt | \
  subjack -w live_subs.txt -t 100 -timeout 30 -o takeover_results.txt

# Alternative: Nuclei for takeover detection
nuclei -l live_subs.txt -t ~/nuclei-templates/takeovers/ -o nuclei_takeovers.txt
```
#### **7. Report Generation (Final Phase)**

```shell
#!/bin/bash
# Generate subdomain enumeration report
REPORT_FILE="subdomain_report_$(date +%Y%m%d_%H%M%S).md"

cat > "$REPORT_FILE" << EOF
# Subdomain Enumeration Report
**Target:** TARGET  
**Date:** $(date)  
**Total Subdomains Discovered:** $(wc -l all_subs_raw.txt | awk '{print $1}')  
**Live Subdomains:** $(wc -l live_subs.txt | awk '{print $1}')

## ðŸ“Š Summary
\`\`\`
$(cat status_codes.txt | head -10)
\`\`\`

## ðŸŽ¯ Critical Subdomains
\`\`\`
$(head -20 critical_subs.txt)
\`\`\`

## ðŸ›  Technologies Detected
\`\`\`
$(cat live_subs_detailed.txt | grep -o "\[.*\]" | sort | uniq -c | sort -rn | head -10)
\`\`\`

## ðŸ“ˆ Statistics
- **Critical Infrastructure:** $(wc -l critical_subs.txt | awk '{print $1}')
- **Development/Staging:** $(wc -l dev_subs.txt | awk '{print $1}')
- **Internal Systems:** $(wc -l internal_subs.txt | awk '{print $1}')
- **Cloud Services:** $(wc -l cloud_subs.txt | awk '{print $1}')

## ðŸš¨ Takeover Vulnerabilities
\`\`\`
$(head -10 takeover_results.txt 2>/dev/null || echo "None detected")
\`\`\`

## ðŸ“‹ Full Subdomain List
\`\`\`
$(head -50 live_subs.txt)
\`\`\`
...and $(($(wc -l live_subs.txt | awk '{print $1}') - 50)) more
EOF

echo "[+] Report generated: $REPORT_FILE"
echo "[+] Total live subdomains: $(wc -l live_subs.txt)"
```
#### **8. Single Pipeline Command (All-in-One)**

```shell
# Complete subdomain enumeration in one command
subfinder -d TARGET -silent | \
amass enum -passive -d TARGET | \
sort -u | \
httpx -silent -title -status-code -tech-detect | \
tee complete_subs.txt
```