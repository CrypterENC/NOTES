### **CSRF lab 0x02 :**
-  How is this lab different from **CSRF Lab 0x01 ?**
	-  Here in this lab we got a **hidden input box with csrf value,** which if we try to create a poc and run it manually in browser it won't work.
	- So we will have to probably Bypass that Token.

- **Now how do we bypass the Token :** 
	
	- Does every form have a CSRF token?
	- Can we use GET instead of POST (i.e. can our payload be in the URI instead of the body)
	- Test the token
	    - Test without the token
	        - Test other HTTP methods without the token (e.g. GET)
	    - Test without the token value (keep the param name, e.g. &csrf=)
	    - Test with a random token
	    - Test a previous token
	    - Test a token from a different session
	    - Test with a token of the same length
	    - Test for predictability
	    - Test for static values
	        - Test for known values (e.g. the token is the user-id)
	    - Is the token tied to a cookie other than the session cookie?
	    - Can the token be stolen with XSS?
	- Is the referrer header being used to validate the request origin?
	- Do the cookies have SameSite set? (Chrome is lax by default)
	    - Can we submit the request with GET?
	    - Can we override HTTP methods with `X-Http-Method-Override: GET`
	    - Can we override HTTP methods with `_method=POST``

-  **Lets perform that :** 
	- **First we will reuse our old csrf code and add the input for input.** 
		```html
		<html>
		  <!-- CSRF PoC - generated by Burp Suite Professional -->
		  <body>
		    <form action="http://localhost/labs/csrf0x01.php" method="POST">
		      <input type="hidden" name="email" value="csrftest@mail.com" />
		      <input type="text" name="csrf" id="csrf" value="RSeI0JNvqwD064" hidden>
		      <input type="submit" value="Submit request" />
		    </form>
		    <script>
		      window.onload = function() {
		        document.forms[0].submit();
		      }
		    </script>
		  </body>
		</html>
		```
	-  This time we will just change the token value and sent the request, **if it works then good if it is not working, then the server is verifying.** ' then we might have to find a way to make token '. 

