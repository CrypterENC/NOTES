### **What is Authorization?**
- **Authorization** determines _what an authenticated user is allowed to do_ within the application.  
                                     OR
- **Authorization** is the _process that verifies "What you can access" after authentication has been confirmed._
#### **Key Difference from Authentication:**
- **Authentication**: "Who are you?" → Verifies identity
- **Authorization**: "What can you do?" → Determines permissions
#### **Types of Authorization Models:**
1. **Role-Based Access Control (RBAC)**
    - Users are assigned roles (Admin, User, Guest)
    - Roles have predefined permissions

2. **Attribute-Based Access Control (ABAC)**
    - Access based on user attributes, resource attributes, and environmental conditions
    - More granular than RBAC

3. **Discretionary Access Control (DAC)**
    - Resource owners decide who gets access
    - Common in file systems

4. **Mandatory Access Control (MAC)**
    - System-enforced policies (military/government systems)
#### **How do Authorization Vulnerabilities Arise?**

- They come from **flawed logic in permission checks** and **failure to properly enforce access controls**.

### **Classic Common Authorization Vulnerabilities**

#### **1. Insecure Direct Object References (IDOR)**

- **Classic Pattern**: Sequential or predictable IDs
    
- **Example**: `GET /api/user/123 → Should only allow user 123, but user 456 can access`
    
- **Real Impact**: View/modify other users' data
    
- **Testing**: Change ID parameters (123→124, etc.)

```bash
curl "https://api.com/users/123"
curl "https://api.com/users/124"  # Should fail but might work

# With authentication
curl -H "Authorization: Bearer user_token" "https://api.com/invoices/1001"
curl -H "Authorization: Bearer user_token" "https://api.com/invoices/1002"
```
#### **2. Missing Function Level Access Control (Vertical Privilege Escalation)**

- **Classic Pattern**: Hidden/admin endpoints accessible to regular users
    
- **Example**: Regular user accessing `/admin/deleteUser.php`
    
- **Real Impact**: Complete system takeover
    
- **Testing**: Try admin paths with user credentials

```bash
# Common admin endpoints to test
/admin
/admin.php
/admin/
/administrator
/backend
/manager
/cpanel
/controlpanel
/dashboard
```
#### **3. Parameter Tampering / Forced Browsing**

- **Classic Pattern**: Changing URL parameters or form fields
    
- **Example**: `?admin=false → ?admin=true`
    
- **Real Impact**: Unauthorized access to features

```http
# Original request
POST /updateProfile HTTP/1.1
Cookie: user=john; role=user

# Tampered request
POST /updateProfile HTTP/1.1
Cookie: user=john; role=admin
```
#### **4. JWT Token Manipulation**

- **Classic Pattern**: Changing JWT claims without re-signing
    
- **Example**: `{"user":"john","role":"user"} → {"user":"john","role":"admin"}`
    
- **Real Impact**: Privilege escalation

```bash
# Decode JWT
echo "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiam9obiIsInJvbGUiOiJ1c2VyIn0" | base64 -d

# Common attacks:
# 1. Change algorithm to "none"
# 2. Change "role" from "user" to "admin"
# 3. Modify expiration date
# 4. Weak HMAC secret brute force
```
#### **5. Cross-Origin Resource Sharing (CORS) Misconfiguration**

- **Classic Pattern**: Wildcard (`*`) or overly permissive origins
    
- **Example**: `Access-Control-Allow-Origin: *` on sensitive endpoints
    
- **Real Impact**: CSRF, data theft

```http
# Vulnerable response
HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
```
#### **6. Forceful Browsing / Directory Traversal**

- **Classic Pattern**: Accessing files/directories not linked in application
    
- **Example**: `/backup.zip`, `/config.ini`, `/../etc/passwd`
    
- **Real Impact**: Information disclosure, source code leakage

```bash
# Common files to try
/.git/HEAD
/.env
/config.php
/backup.sql
/phpinfo.php
/server-status
```
#### **7. Insecure Cryptographic Storage**

- **Classic Pattern**: Plain text or weakly hashed passwords
    
- **Example**: Password stored as MD5 without salt
    
- **Real Impact**: Password recovery if database breached

```sql
-- Vulnerable database entries
-- Plain text: password123
-- MD5: 482c811da5d5b4bc6d497ffa98491e38 (password123)
-- SHA1: 40bd001563085fc35165329ea1ff5c5ecbdbbeef (123)
```
#### **8. Session Fixation**

- **Classic Pattern**: Session ID doesn't change after login
    
- **Example**: Attacker sets victim's session ID, victim logs in, attacker uses same session
    
- **Real Impact**: Account takeover

```http
# Attacker gets session ID
GET /login.php
Set-Cookie: SESSID=attacker_chosen_id

# Victim logs in with same session ID
POST /login.php
Cookie: SESSID=attacker_chosen_id
```
#### **9. Missing Authorization on API Endpoints**

- **Classic Pattern**: APIs without proper authentication checks
    
- **Example`: REST API endpoints that don't verify user permissions
    
- **Real Impact**: Unauthorized API access

```bash
# Test without authentication
curl -X GET https://api.com/users
curl -X POST https://api.com/users
curl -X DELETE https://api.com/users/1
```
#### **10. Business Logic Flaws**

- **Classic Pattern**: Flaws in application workflow
    
- **Examples**:
    
    - Can purchase negative quantities
        
    - Can apply discount multiple times
        
    - Can bypass payment steps
        
- **Real Impact**: Financial loss

```http
# Example: Negative quantity attack
POST /cart/update HTTP/1.1
{"item_id": "123", "quantity": -10}  # Get paid instead of paying

```
#### **11. Mass Assignment**

- **Classic Pattern**: User can set fields they shouldn't
    
- **Example**: Registration form allows setting `isAdmin=true`
    
- **Real Impact**: Privilege escalation

```http
POST /register HTTP/1.1
{
  "username": "attacker",
  "password": "pass123",
  "email": "attacker@example.com",
  "isAdmin": true,        # Should not be allowed
  "balance": 1000         # Should not be allowed
}
```
#### **12. Horizontal Privilege Escalation**

- **Classic Pattern**: User A can access User B's resources
    
- **Example**: `GET /api/orders?user_id=456` when logged in as user 123
    
- **Real Impact**: Data breach between users

```bash
# Test with different user IDs
curl -H "Authorization: Bearer user123_token" "https://api.com/orders?user_id=123"
curl -H "Authorization: Bearer user123_token" "https://api.com/orders?user_id=124"  # Should fail
```



#### **13. Insecure Redirects and Forwards**

- **Classic Pattern**: Redirects without validation
    
- **Example**: `https://bank.com/redirect?url=evil.com`
    
- **Real Impact**: Phishing, open redirect
    

bash

# Test for open redirects
curl -I "https://target.com/redirect?url=http://evil.com"
curl -I "https://target.com/redirect?url=//evil.com"

#### **14. Verbose Error Messages**

- **Classic Pattern**: Error messages reveal authorization logic
    
- **Example**: "Admin access required" vs "Invalid user"
    
- **Real Impact**: Information disclosure
    

http

# Good error (generic)
HTTP/1.1 403 Forbidden
{"error": "Access denied"}

# Bad error (revealing)
HTTP/1.1 403 Forbidden
{"error": "Admin role required to access this endpoint"}

#### **15. Default Credentials**

- **Classic Pattern**: Admin:admin, root:root, etc.
    
- **Example**: Default admin panel credentials
    
- **Real Impact**: Easy unauthorized access
    

bash

# Common default credentials
admin:admin
administrator:password
root:root
user:user
test:test